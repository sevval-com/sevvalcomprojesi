@using Microsoft.AspNetCore.Identity
@inject UserManager<ApplicationUser> UserManager
@model sevvalemlak.Dto.TumIlanlarDTO

@{
    ViewData["Title"] = "Ana Sayfa";
}
@section style {
    <!-- Bootstrap 5 CSS (K√ºt√ºphane) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Swiper CSS (K√ºt√ºphane) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Orijinal Stil Dosyasƒ± -->
    <link rel="stylesheet" type="text/css" href="~/css/yorumlar.css" />

    <style>
        /* Onaysƒ±z yorumlarƒ± adminin ayƒ±rt etmesi i√ßin */
        .comment-unapproved {
            border-left: 4px solid #ffc107; /* Sarƒ± kenarlƒ±k */
            background-color: #fffdf5;
        }
    </style>
}
<style>
    /* --- ORƒ∞Jƒ∞NAL Sƒ∞TE STƒ∞LLERƒ∞ --- */
    .recently-visited-section {
        margin: 30px 0;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
    }

    .section-title {
        text-align: center;
        font-size: 28px;
        font-weight: 700;
        color: #0078d7;
        margin-bottom: 25px;
    }

    .recently-visited-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 20px;
        overflow: hidden;
    }

    .result-item {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 10px;
        overflow: hidden;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        cursor: pointer;
        box-sizing: border-box;
    }

        .result-item:hover {
            transform: scale(1);
            border-color: #0078d7;
            box-shadow: 0 8px 24px 0 rgba(0, 120, 215, 0.18), 0 2px 8px 0 rgba(0, 120, 215, 0.10);
        }

    .result-image {
        position: relative;
        width: 100%;
        height: 180px;
        overflow: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
    }

        .result-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .result-image i.fa-camera {
            font-size: 50px;
            color: #007bff;
        }

    .result-price {
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: rgba(0, 120, 215, 0.85);
        color: #fff;
        padding: 5px 12px;
        font-size: 16px;
        border-radius: 4px;
        font-weight: bold;
    }

    .new-badge {
        position: absolute;
        top: 10px;
        left: 10px;
        background-color: #007bff;
        color: white;
        padding: 5px 10px;
        font-size: 14px;
        font-weight: bold;
        border-radius: 5px;
    }

    .result-details {
        padding: 15px;
        text-align: left;
    }

        .result-details h3 {
            font-size: 18px;
            color: #003d66;
            margin: 0 0 10px;
            font-weight: 600;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: left;
        }

            .result-details h3 a {
                color: inherit;
                text-decoration: none;
            }

                .result-details h3 a:hover {
                    color: #0078d7;
                }

    .result-description {
        font-size: 14px;
        color: #666;
        margin: 8px 0;
        gap: 8px;
        line-height: 1.4;
        display: flex;
    }

    .detail-item-legacy {
        white-space: nowrap;
    }

    .separator {
        color: #999;
        margin: 0 5px;
    }

    .view-all-container {
        text-align: center;
        margin-top: 20px;
    }

    .view-all-btn {
        display: inline-block;
        background-color: #0078d7;
        color: white;
        padding: 12px 24px;
        border-radius: 25px;
        text-decoration: none;
        font-weight: 600;
        transition: background-color 0.3s ease;
    }

        .view-all-btn:hover {
            background-color: #106ebe;
            color: white;
            text-decoration: none;
        }

    /* Popups Font D√ºzeltmeleri (Masa√ºst√º i√ßin varsayƒ±lanlar) */
    .popups-container .service-popup h3,
    .popups-container .service-popup-2 h3 {
        font-size: 15px !important;
        margin-top: 5px !important;
        margin-bottom: 5px !important;
        line-height: 1.2 !important;
        font-weight: 700 !important;
    }

    .popups-container .sevvaldrone-popup h3 {
        font-size: 20px !important;
        margin-top: 5px !important;
        margin-bottom: 5px !important;
        line-height: 1.2 !important;
        font-weight: 700 !important;
    }

    .popups-container .service-popup p,
    .popups-container .service-popup-2 p {
        font-size: 11px !important;
        line-height: 1.3 !important;
        margin-bottom: 5px !important;
    }

    .popups-container .sevvaldrone-popup p {
        font-size: 14px !important;
        line-height: 1.3 !important;
        margin-bottom: 5px !important;
    }

    .popups-container .property-image,
    .popups-container .property-image-2 {
        width: 120px !important;
        height: auto !important;
        margin-bottom: 5px !important;
    }

    .popups-container .drone-icon img {
        width: 60px !important;
        height: 60px !important;
    }

    /* Genel Etiketler - Saƒü √úste Konumlandƒ±r */
    .popups-container .label,
    .popups-container .label-2 {
        font-size: 13px !important;
        padding: 5px 10px !important;
        position: absolute !important;
        top: 10px !important;
        right: 10px !important;
        background-color: #dc3545 !important; /* Kƒ±rmƒ±zƒ± renk */
        color: white !important;
        border-radius: 4px !important;
        z-index: 10 !important;
    }

    .popups-container .sevvaldrone-popup .label {
        font-size: 18px !important;
        font-weight: 800 !important;
        padding: 6px 12px !important;
        position: absolute !important;
        top: 10px !important;
        right: 10px !important;
        background-color: #dc3545 !important; /* Kƒ±rmƒ±zƒ± renk */
        color: white !important;
        border-radius: 4px !important;
        z-index: 10 !important;
    }

    /* --- POPUPS CONTAINER RESPONSIVE AYARLARI (MOBƒ∞L YAN YANA) --- */
    @@media (max-width: 768px) {
        .popups-container {
            display: flex !important;
            flex-direction: row !important; /* Yan yana zorla */
            flex-wrap: nowrap !important; /* A≈üaƒüƒ± kaymayƒ± engelle */
            justify-content: space-between !important;
            gap: 5px !important;
            width: 100% !important;
            padding: 10px 5px !important;
            box-sizing: border-box !important;
            overflow-x: auto !important; /* Ta≈üarsa kaydƒ±r */
        }

        .service-popup,
        .service-popup-2,
        .sevvaldrone-popup {
            flex: 1 !important;
            min-width: 0 !important; /* ƒ∞√ßerik ta≈ümasƒ±nƒ± engelle */
            width: 32% !important;
            margin: 0 !important;
            padding: 5px !important;
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            text-align: center !important;
            position: relative !important;
            top: auto !important;
            left: auto !important;
            transform: none !important;
            height: auto !important;
            min-height: 130px !important;
        }
        /* Mobilde G√∂rselleri K√º√ß√ºlt */
        .popups-container .property-image,
        .popups-container .property-image-2 {
            width: 45px !important; /* Mobilde k√º√ß√ºk resim */
            height: auto !important;
            margin-bottom: 2px !important;
        }

        .popups-container .drone-icon img {
            width: 40px !important;
            height: 40px !important;
        }

        .popups-container .drone-icon {
            width: 45px !important;
            height: 45px !important;
        }
        /* Mobilde Yazƒ±larƒ± K√º√ß√ºlt */
        .popups-container .service-popup h3,
        .popups-container .service-popup-2 h3,
        .popups-container .sevvaldrone-popup h3 {
            font-size: 10px !important; /* Ba≈ülƒ±klar k√º√ß√ºk */
            line-height: 1.1 !important;
            margin: 2px 0 !important;
            white-space: normal !important;
        }

        .popups-container .service-popup p,
        .popups-container .service-popup-2 p,
        .popups-container .sevvaldrone-popup p {
            font-size: 8px !important; /* A√ßƒ±klamalar √ßok k√º√ß√ºk */
            line-height: 1.1 !important;
            margin: 0 !important;
            display: -webkit-box;
            -webkit-line-clamp: 3; /* 3 satƒ±rla sƒ±nƒ±rla */
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        /* Mobilde Etiketleri K√º√ß√ºlt ve Saƒü √úste Ta≈üƒ± (D√úZELTƒ∞LDƒ∞) */
        .popups-container .label,
        .popups-container .label-2 {
            font-size: 7px !important; /* K√º√ß√ºlt√ºld√º */
            padding: 2px 3px !important;
            position: absolute !important;
            top: 0 !important;
            right: 0 !important; /* Saƒü √ºste ta≈üƒ±ndƒ± */
            left: auto !important; /* Left auto yapƒ±ldƒ± */
            border-radius: 0 4px 0 4px !important; /* Border radius g√ºncellendi */
        }

        .popups-container .sevvaldrone-popup .label {
            font-size: 9px !important; /* K√º√ß√ºlt√ºld√º */
            padding: 2px 3px !important;
            top: 0 !important;
            right: 0 !important;
            left: auto !important;
        }
        /* Bilgi ƒ∞konu */
        .info-icon {
            width: 14px !important;
            height: 14px !important;
            font-size: 10px !important;
            line-height: 14px !important;
            top: 2px !important;
            right: 2px !important;
        }
    }

    /* Responsive tasarƒ±m (Diƒüer Kƒ±sƒ±mlar) */
    @@media (max-width: 768px) {
        .recently-visited-grid {
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .section-title {
            font-size: 24px;
        }

        .result-image {
            height: 150px;
        }

        .result-details {
            padding: 12px;
        }

            .result-details h3 {
                font-size: 16px;
            }

        .logo img {
            width: 70px;
        }
        /* G√ºn√ºn ƒ∞lanƒ± Butonu K√º√ß√ºltme */
        .floating-offer-img {
            width: 60px !important;
            height: 60px !important;
        }
    }

    @@media (max-width: 480px) {
        .recently-visited-grid {
            /* ƒ∞lanlarƒ± mobilde 2'li (yan yana) g√∂ster */
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        /* ƒ∞lan kartƒ± i√ßindeki g√∂rselleri mobilde biraz k√º√ß√ºlt */
        .result-image {
            height: 120px;
        }

        .result-details h3 {
            font-size: 13px;
        }

        .recently-visited-section {
            margin: 20px 0;
            padding: 15px;
        }
    }

    /* --- G√úN√úN ƒ∞LANI STƒ∞LLERƒ∞ (BENZERSƒ∞Z ƒ∞Sƒ∞MLENDƒ∞RME) --- */

    .daily-offer-modal-custom .modal-content {
        background: linear-gradient(135deg, #009cfb 0%, #0056b3 100%);
        border-radius: 20px;
        border: none;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        color: white;
        overflow: hidden;
    }

    /* Kapatma Butonu */
    .daily-offer-close-btn {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 50%;
        width: 36px;
        height: 36px;
        padding: 0;
        margin: 0;
        aspect-ratio: 1;
        color: white;
        font-size: 18px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        z-index: 1060;
    }

        .daily-offer-close-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

    .daily-offer-left-col {
        padding: 30px;
        height: 100%;
        display: flex;
        flex-direction: column;
        gap: 30px;
        justify-content: flex-start;
    }

    .daily-offer-right-col {
        padding: 30px;
        height: 100%;
        display: flex;
        flex-direction: column;
    }

    /* Etiketler */
    .daily-offer-tags-wrapper {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 15px;
    }

    .daily-offer-tag {
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.8px;
        white-space: nowrap;
        display: inline-block;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
        border: 2px solid transparent;
        color: white;
    }

        .daily-offer-tag:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

    .daily-offer-cat {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.25) 0%, rgba(255, 255, 255, 0.15) 100%);
        border-color: rgba(255, 255, 255, 0.3);
    }

        .daily-offer-cat::after {
            content: "üèòÔ∏è";
            margin-left: 6px;
        }

    .daily-offer-stat {
        background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
        border-color: rgba(76, 175, 80, 0.5);
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
    }

        .daily-offer-stat::after {
            content: "‚úì";
            margin-left: 6px;
            font-weight: bold;
        }

    .daily-offer-subcat {
        background: linear-gradient(135deg, #2196F3 0%, #1976D2 100%);
        border-color: rgba(33, 150, 243, 0.5);
        box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
    }

        .daily-offer-subcat::after {
            content: "üìå";
            margin-left: 6px;
        }

    /* Fiyat Kutusu */
    .daily-offer-price-box {
        margin-bottom: 20px;
        background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 165, 0, 0.2) 100%);
        padding: 15px;
        border-radius: 12px;
        border-left: 4px solid #FFD700;
        box-shadow: 0 4px 15px rgba(255, 215, 0, 0.2);
    }

    .daily-offer-price-lbl {
        font-size: 12px;
        opacity: 0.9;
        margin-bottom: 5px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.8px;
    }

    .daily-offer-price-val {
        font-size: 32px;
        font-weight: 800;
        background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.5));
        animation: dailyOfferPriceGlow 2s ease-in-out infinite;
    }

    @@keyframes dailyOfferPriceGlow {
        0%, 100% {
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4)) brightness(1);
        }

        50% {
            filter: drop-shadow(0 0 30px rgba(255, 215, 0, 0.8)) brightness(1.2);
        }
    }

    /* Ba≈ülƒ±k ve Konum */
    .daily-offer-title-box .daily-offer-title-text {
        font-size: 22px;
        font-weight: 700;
        margin: 0 0 12px 0;
        line-height: 1.3;
        color: white;
    }

    .daily-offer-loc-box {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 20px;
        font-size: 14px;
        opacity: 0.9;
    }

    .daily-offer-loc-icon {
        color: #01e11b;
    }

    /* √ñzellikler Grid */
    .daily-offer-feat-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
        gap: 10px;
        margin-bottom: 20px;
    }

    .daily-offer-feat-item {
        display: flex;
        align-items: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.12);
        padding: 8px 12px;
        border-radius: 10px;
        font-size: 12px;
        font-weight: 500;
        transition: all 0.3s ease;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(5px);
        color: white;
    }

        .daily-offer-feat-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 5px 20px rgba(1, 225, 27, 0.3);
            border-color: #01e11b;
        }

    .daily-offer-feat-icon {
        color: #01e11b;
        width: 20px;
        font-size: 18px;
        transition: transform 0.3s ease;
        filter: drop-shadow(0 0 5px rgba(1, 225, 27, 0.5));
    }

    .daily-offer-feat-item:hover .daily-offer-feat-icon {
        transform: rotate(360deg) scale(1.2);
    }

    /* ƒ∞leti≈üim */
    .daily-offer-contact-box {
        background: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 12px;
        backdrop-filter: blur(10px);
        margin-top: 0;
    }

    .daily-offer-contact-info {
        margin-bottom: 12px;
    }

    .daily-offer-contact-row {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
        font-size: 13px;
    }

    .daily-offer-contact-icon {
        color: #01e11b;
        width: 16px;
    }

    .daily-offer-contact-btns {
        display: flex;
        gap: 10px;
    }

    .daily-offer-contact-btn {
        flex: 1;
        padding: 10px 16px;
        border: none;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        transition: all 0.3s ease;
        text-decoration: none;
        color: white;
    }

    .daily-offer-wa-btn {
        background: #25d366;
    }

        .daily-offer-wa-btn:hover {
            background: #128c7e;
            transform: translateY(-2px);
            color: white;
        }

    .daily-offer-call-btn {
        background: #009cfb;
    }

        .daily-offer-call-btn:hover {
            background: #0056b3;
            transform: translateY(-2px);
            color: white;
        }

    /* Slider */
    .daily-offer-slider-wrap {
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        border: 2px solid rgba(255, 255, 255, 0.15);
        height: 450px;
        position: relative;
    }

    .swiper-slide {
        background: rgba(0,0,0,0.2);
    }
    /* K√ºt√ºphane sƒ±nƒ±fƒ± */
    .daily-offer-slider-wrap .swiper-slide img {
        width: 100%;
        height: 100%;
        object-fit: contain;
    }

    /* Aksiyonlar */
    .daily-offer-action-box {
        margin-top: 20px;
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
    }

    .daily-offer-action-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        padding: 12px 20px;
        border-radius: 10px;
        font-weight: 700;
        font-size: 14px;
        transition: all 0.3s ease;
        text-decoration: none;
        color: white;
        border: 2px solid rgba(255, 255, 255, 0.3);
        position: relative;
        overflow: hidden;
        backdrop-filter: blur(10px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        width: 100%;
    }

    .daily-offer-btn-primary {
        background: linear-gradient(135deg, #01e11b 0%, #00c41a 100%);
        box-shadow: 0 4px 12px rgba(1, 225, 27, 0.3);
    }

        .daily-offer-btn-primary:hover {
            background: linear-gradient(135deg, #00c41a 0%, #00a015 100%);
            transform: translateY(-3px) scale(1.02);
            color: white;
            border-color: rgba(255, 255, 255, 0.5);
        }

    .daily-offer-btn-orange {
        background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
        box-shadow: 0 4px 12px rgba(243, 156, 18, 0.3);
    }

        .daily-offer-btn-orange:hover {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
            transform: translateY(-3px) scale(1.02);
            color: white;
            border-color: rgba(255, 255, 255, 0.5);
        }

    .daily-offer-view-cnt {
        grid-column: span 2;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        background: rgba(255, 255, 255, 0.2);
        padding: 10px 18px;
        border-radius: 10px;
        color: white;
        font-size: 16px;
        font-weight: 700;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.3);
        transition: all 0.3s ease;
        width: 100%;
    }

        .daily-offer-view-cnt:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

    /* Swiper √ñzel Stil */
    .daily-offer-modal-custom .swiper-button-prev,
    .daily-offer-modal-custom .swiper-button-next {
        color: white;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
    }

        .daily-offer-modal-custom .swiper-button-prev:after,
        .daily-offer-modal-custom .swiper-button-next:after {
            font-size: 24px;
            font-weight: bold;
        }

    /* ORTA EKRAN (TABLET) */
    @@media (min-width: 769px) and (max-width: 991px) {
        .modal-lg-custom {
            max-width: 95%;
            margin: 10px auto;
        }

        .daily-offer-left-col {
            padding: 15px;
            overflow-y: auto;
            max-height: 400px;
            gap: 15px;
        }

        .daily-offer-right-col {
            padding: 15px;
        }

        .daily-offer-slider-wrap {
            height: 250px;
        }

        .daily-offer-price-val {
            font-size: 26px;
        }

        .daily-offer-title-text {
            font-size: 18px;
        }

        .daily-offer-contact-btns {
            flex-direction: row;
        }

        .daily-offer-action-box {
            gap: 10px;
        }

        .daily-offer-action-btn {
            padding: 10px 10px;
            font-size: 12px;
        }
    }

    /* MOBƒ∞L EKRAN ƒ∞√áƒ∞N √ñZEL "TEKTE G√ñSTERME" AYARLARI */
    @@media (max-width: 768px) {
        .daily-offer-modal-custom {
            padding-top: 60px !important;
            padding-left: 10px !important;
            padding-right: 10px !important;
        }
        
        .daily-offer-modal-custom .modal-dialog {
            margin-top: 0 !important;
            margin-left: auto !important;
            margin-right: auto !important;
            max-width: calc(100% - 20px) !important;
        }
        
        .modal-lg-custom {
            max-width: calc(100% - 20px) !important;
            margin: 10px auto !important;
            max-height: 95vh !important;
        }

        .daily-offer-modal-custom .modal-content {
            max-height: 85vh !important;
            overflow: hidden !important;
            width: 100% !important;
        }
        /* ƒ∞√ßerikler sƒ±ƒüsƒ±n */
        .daily-offer-left-col {
            padding: 10px !important;
            overflow: hidden !important;
            max-height: none !important;
            gap: 4px !important;
        }

        .daily-offer-right-col {
            padding: 8px 10px !important;
            gap: 4px !important;
            overflow: hidden !important;
        }
        /* Slider y√ºksekliƒüini k√º√ß√ºlt */
        .daily-offer-slider-wrap {
            height: 140px !important;
            border-radius: 10px !important;
        }
        /* Fiyat */
        .daily-offer-price-val {
            font-size: 18px !important;
        }

        .daily-offer-price-lbl {
            font-size: 9px !important;
            margin-bottom: 1px !important;
        }

        .daily-offer-price-box {
            padding: 5px !important;
            margin-bottom: 4px !important;
        }
        /* Ba≈ülƒ±k */
        .daily-offer-title-text {
            font-size: 13px !important;
            margin-bottom: 3px !important;
            line-height: 1.2 !important;
        }

        .daily-offer-title-box {
            margin-bottom: 0 !important;
        }
        /* Konum */
        .daily-offer-loc-box {
            font-size: 9px !important;
            margin-bottom: 4px !important;
        }
        /* Etiketler */
        .daily-offer-tags-wrapper {
            margin-bottom: 4px !important;
            gap: 3px !important;
        }

        .daily-offer-tag {
            padding: 2px 5px !important;
            font-size: 8px !important;
        }
        /* √ñzellikler Grid */
        .daily-offer-feat-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr) !important;
            gap: 3px !important;
            margin-bottom: 4px !important;
        }

        .daily-offer-feat-item {
            padding: 3px !important;
            font-size: 9px !important;
        }

        .daily-offer-feat-icon {
            font-size: 10px !important;
        }
        /* ƒ∞leti≈üim Kutusu - Mobil: Yan yana d√ºzen */
        .daily-offer-contact-box {
            padding: 5px !important;
            margin-top: 0 !important;
            display: flex !important;
            flex-direction: row !important;
            align-items: center !important;
            justify-content: space-between !important;
            gap: 6px !important;
        }

        .daily-offer-contact-info {
            flex: 1 !important;
            margin-bottom: 0 !important;
        }

        .daily-offer-contact-row {
            font-size: 9px !important;
            margin-bottom: 2px !important;
        }

        .daily-offer-contact-btns {
            display: flex !important;
            flex-direction: column !important;
            gap: 3px !important;
            flex-shrink: 0 !important;
        }

        .daily-offer-contact-btn {
            padding: 5px 22px !important;
            font-size: 9px !important;
            white-space: nowrap !important;
        }
        /* Butonlar */
        .daily-offer-action-box {
            gap: 4px !important;
            margin-top: 6px !important;
        }

        .daily-offer-action-btn {
            padding: 6px !important;
            font-size: 10px !important;
        }

        .daily-offer-view-cnt {
            padding: 4px !important;
            font-size: 9px !important;
            margin-top: 0 !important;
        }
        /* Kapatma butonu biraz daha k√º√ß√ºk */
        .daily-offer-close-btn {
            width: 30px !important;
            height: 30px !important;
            top: 10px !important;
            right: 10px !important;
            font-size: 14px !important;
        }
    }

    /* √áOK K√ú√á√úK EKRANLAR ƒ∞√áƒ∞N (iPhone SE, vb.) */
    @@media (max-width: 375px) {
        .modal-lg-custom {
            max-width: 88% !important;
            margin: 10px auto !important;
            max-height: 95vh !important;
        }

        .daily-offer-modal-custom .modal-content {
            max-height: 92vh !important;
            overflow: hidden !important;
        }

        .daily-offer-left-col {
            padding: 12px !important;
            gap: 5px !important;
        }

        .daily-offer-right-col {
            padding: 8px 12px !important;
        }

        .daily-offer-slider-wrap {
            height: 130px !important;
        }

        .daily-offer-price-val {
            font-size: 18px !important;
        }

        .daily-offer-price-box {
            padding: 6px !important;
            margin-bottom: 5px !important;
        }

        .daily-offer-title-text {
            font-size: 13px !important;
        }

        .daily-offer-loc-box {
            font-size: 10px !important;
            margin-bottom: 5px !important;
        }

        .daily-offer-tags-wrapper {
            margin-bottom: 5px !important;
        }

        .daily-offer-tag {
            padding: 3px 6px !important;
            font-size: 8px !important;
        }

        .daily-offer-feat-grid {
            grid-template-columns: repeat(2, 1fr) !important;
            gap: 3px !important;
            margin-bottom: 5px !important;
        }

        .daily-offer-feat-item {
            padding: 4px !important;
            font-size: 9px !important;
        }

        .daily-offer-feat-icon {
            font-size: 12px !important;
            margin-right: 4px !important;
        }

        .daily-offer-contact-box {
            padding: 6px !important;
            display: flex !important;
            flex-direction: row !important;
            align-items: center !important;
            justify-content: space-between !important;
            gap: 6px !important;
        }

        .daily-offer-contact-info {
            flex: 1 !important;
            margin-bottom: 0 !important;
        }

        .daily-offer-contact-row {
            font-size: 10px !important;
            margin-bottom: 3px !important;
        }

        .daily-offer-contact-btns {
            display: flex !important;
            flex-direction: column !important;
            gap: 3px !important;
            flex-shrink: 0 !important;
        }

        .daily-offer-contact-btn {
            padding: 5px 8px !important;
            font-size: 9px !important;
            white-space: nowrap !important;
        }

        .daily-offer-action-box {
            gap: 4px !important;
            margin-top: 5px !important;
        }

        .daily-offer-action-btn {
            padding: 6px !important;
            font-size: 10px !important;
        }

        .daily-offer-view-cnt {
            padding: 4px !important;
            font-size: 10px !important;
        }

        .daily-offer-close-btn {
            width: 26px !important;
            height: 26px !important;
            top: 5px !important;
            right: 5px !important;
            font-size: 12px !important;
        }
    }

    @@media (min-width: 992px) {
        .modal-lg-custom {
            max-width: 1200px;
            width: 95%;
        }

        .daily-offer-left-col {
            border-right: 1px solid rgba(255,255,255,0.1);
        }
    }

    /* --- √úYELERƒ∞Mƒ∞Z B√ñL√úM√ú YENƒ∞ TASARIM (SCROLLABLE) --- */
    .advisor-container {
        margin: 40px 0;
        padding: 30px 15px;
        background: linear-gradient(135deg, #0078d7 0%, #005a9e 100%);
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 120, 215, 0.2);
    }

    .advisor-wrapper {
        display: flex;
        flex-wrap: nowrap; /* Kartlar tek satƒ±rda kalsƒ±n */
        overflow-x: auto; /* Yatay kaydƒ±rma */
        gap: 20px;
        padding: 20px 10px;
        cursor: grab; /* Tutulabilir imle√ß */
        -webkit-overflow-scrolling: touch; /* Mobilde yumu≈üak kaydƒ±rma */
        scrollbar-width: thin; /* Firefox i√ßin ince scrollbar */
        scrollbar-color: rgba(255,255,255,0.5) transparent;
    }

        .advisor-wrapper::-webkit-scrollbar {
            height: 8px;
        }

        .advisor-wrapper::-webkit-scrollbar-track {
            background: transparent;
        }

        .advisor-wrapper::-webkit-scrollbar-thumb {
            background-color: rgba(255,255,255,0.3);
            border-radius: 4px;
        }

    .advisor-card {
        background-color: #ffffff;
        border-radius: 12px;
        width: 220px; /* Sabit geni≈ülik */
        min-width: 220px; /* Sƒ±kƒ±≈ümayƒ± √∂nler */
        padding: 20px 15px;
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 1px solid rgba(0,0,0,0.05);
    }

        .advisor-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

    .advisor-img-wrapper {
        width: 90px;
        height: 90px;
        border-radius: 50%;
        overflow: hidden;
        margin-bottom: 15px;
        border: 3px solid #eef2f6;
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        flex-shrink: 0;
    }

    .advisor-img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.3s;
    }

    .advisor-card:hover .advisor-img {
        transform: scale(1.1);
    }

    .advisor-info {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        flex-grow: 1;
    }

    .advisor-name {
        font-size: 16px;
        font-weight: 700;
        color: #2c3e50;
        margin: 5px 0;
        width: 100%;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }

    .advisor-email {
        font-size: 13px;
        color: #7f8c8d;
        margin-bottom: 15px;
        font-weight: 500;
    }

    .advisor-btn {
        background-color: #0078d7;
        color: white !important;
        padding: 8px 24px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 13px;
        font-weight: 600;
        transition: all 0.3s ease;
        margin-top: auto;
    }

        .advisor-btn:hover {
            background-color: #0056b3;
            box-shadow: 0 4px 10px rgba(0, 120, 215, 0.3);
            transform: scale(1.05);
        }
</style>

@if (ViewBag.GununIlan != null)
{
    <script>
        (function() {
            async function refreshDailyOfferViewCount() {
                try {
                    const response = await fetch('@Url.Action("GetDailyOfferViewCount", "Home")', { cache: 'no-store' });
                    if (!response.ok) return;
                    const data = await response.json();
                    if (data && data.success) {
                        const el = document.getElementById('dailyOfferViewCountText');
                        if (el) {
                            el.innerHTML = data.count + ' g√∂r√ºnt√ºlenme';
                        }
                    }
                } catch (e) { }
            }
            refreshDailyOfferViewCount();
            setInterval(refreshDailyOfferViewCount, 60000);
        })();
    </script>

    <!-- Bootstrap 5 Modal - Benzersiz Sƒ±nƒ±flar -->
    <div class="modal fade daily-offer-modal-custom" id="dailyOfferModal" tabindex="-1" aria-labelledby="dailyOfferLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-lg-custom">
            <div class="modal-content">
                <!-- Close Button -->
                <button type="button" class="daily-offer-close-btn" data-bs-dismiss="modal" aria-label="Close">
                    <i class="fas fa-times"></i>
                </button>

                <div class="modal-body p-0">
                    <div class="row g-0">
                        <!-- Sol Taraf: Bilgiler -->
                        <div class="col-lg-5 col-12 order-2 order-lg-1">
                            <div class="daily-offer-left-col">
                                <div>
                                    <!-- Tags -->
                                    <div class="daily-offer-tags-wrapper">
                                        @{
                                            var category = string.IsNullOrWhiteSpace(ViewBag.GununIlan.Category) ? "" : ViewBag.GununIlan.Category;
                                            var status = string.IsNullOrWhiteSpace(ViewBag.GununIlan.KonutDurumu) ? "" : ViewBag.GununIlan.KonutDurumu;
                                            var subCategory = string.IsNullOrWhiteSpace(ViewBag.GununIlan.MulkTipi) ? "" : ViewBag.GununIlan.MulkTipi;
                                        }

                                        @if (!string.IsNullOrEmpty(category))
                                        {
                                            <span class="daily-offer-tag daily-offer-cat">@category</span>
                                        }
                                        @if (!string.IsNullOrEmpty(status))
                                        {
                                            <span class="daily-offer-tag daily-offer-stat">@status</span>
                                        }
                                        @if (!string.IsNullOrEmpty(subCategory))
                                        {
                                            <span class="daily-offer-tag daily-offer-subcat">@subCategory</span>
                                        }
                                    </div>

                                    <!-- Price -->
                                    <div class="daily-offer-price-box">
                                        <div class="daily-offer-price-lbl">Fiyat</div>
                                        <div class="daily-offer-price-val">@($"{ViewBag.GununIlan.Price:N0} TL")</div>
                                    </div>

                                    <!-- Title -->
                                    <div class="daily-offer-title-box">
                                        <h2 class="daily-offer-title-text">@ViewBag.GununIlan.Title</h2>
                                    </div>

                                    <!-- Location -->
                                    @{
                                        List<string> locationList = new List<string>();
                                        locationList.Add(ViewBag.GununIlan.sehir);
                                        locationList.Add(ViewBag.GununIlan.semt);
                                        locationList.Add(ViewBag.GununIlan.mahalleKoy);
                                    }
                                    <div class="daily-offer-loc-box">
                                        <i class="fas fa-map-marker-alt daily-offer-loc-icon"></i>
                                        <span>@string.Join(" | ", locationList.Where(a => !string.IsNullOrEmpty(a)))</span>
                                    </div>

                                    <!-- Details Grid (Dolu/Bo≈ü Kontroll√º) -->
                                    <div class="daily-offer-feat-grid">
                                        @if (!string.IsNullOrEmpty(ViewBag.GununIlan.Area?.ToString()) && ViewBag.GununIlan.Area?.ToString() != "0")
                                        {
                                            <div class="daily-offer-feat-item">
                                                <i class="fas fa-ruler-combined daily-offer-feat-icon"></i>
                                                <span>@ViewBag.GununIlan.Area?.ToString("N0") m¬≤</span>
                                            </div>
                                        }
                                        @if (!string.IsNullOrEmpty(ViewBag.GununIlan.AdaNo?.ToString()))
                                        {
                                            <div class="daily-offer-feat-item">
                                                <i class="fas fa-map daily-offer-feat-icon"></i>
                                                <span>Ada: @ViewBag.GununIlan.AdaNo</span>
                                            </div>
                                        }
                                        @if (!string.IsNullOrEmpty(ViewBag.GununIlan.ParselNo?.ToString()))
                                        {
                                            <div class="daily-offer-feat-item">
                                                <i class="fas fa-map daily-offer-feat-icon"></i>
                                                <span>Parsel: @ViewBag.GununIlan.ParselNo</span>
                                            </div>
                                        }
                                        @if (!string.IsNullOrEmpty(ViewBag.GununIlan.OdaSayisi?.ToString()) && ViewBag.GununIlan.OdaSayisi?.ToString() != "0")
                                        {
                                            <div class="daily-offer-feat-item">
                                                <i class="fas fa-bed daily-offer-feat-icon"></i>
                                                <span>@ViewBag.GununIlan.OdaSayisi Oda</span>
                                            </div>
                                        }
                                        @if (!string.IsNullOrEmpty(ViewBag.GununIlan.BinaYasi?.ToString()))
                                        {
                                            <div class="daily-offer-feat-item">
                                                <i class="fas fa-building daily-offer-feat-icon"></i>
                                                <span>@ViewBag.GununIlan.BinaYasi Ya≈üƒ±nda</span>
                                            </div>
                                        }
                                    </div>
                                </div>

                                <!-- Contact Section (Firma Adƒ± Eklendi) -->
                                <div class="daily-offer-contact-box">
                                    <div class="daily-offer-contact-info">
                                        <div class="daily-offer-contact-row">
                                            <i class="fas fa-user daily-offer-contact-icon"></i>
                                            <span>@ViewBag.KullaniciAdSoyad</span>
                                        </div>
                                        <div class="daily-offer-contact-row">
                                            <i class="fas fa-phone daily-offer-contact-icon"></i>
                                            @{
                                                string rawPhone = (ViewBag.GununIlan.PhoneNumber ?? "").ToString();
                                                var sbPhone = new System.Text.StringBuilder();
                                                foreach (var ch in rawPhone)
                                                {
                                                    if (char.IsDigit(ch)) sbPhone.Append(ch);
                                                }
                                                string digits = sbPhone.ToString();
                                                if (digits.StartsWith("90") && digits.Length == 12)
                                                {
                                                    digits = "0" + digits.Substring(2);
                                                }
                                                if (digits.Length == 10)
                                                {
                                                    digits = "0" + digits;
                                                }
                                                string formattedPhone = rawPhone;
                                                if (digits.Length >= 11)
                                                {
                                                    formattedPhone = $"0 {digits.Substring(1, 3)} {digits.Substring(4, 3)} {digits.Substring(7, 2)} {digits.Substring(9, 2)}";
                                                }
                                            }
                                            <span>@formattedPhone</span>
                                        </div>
                                        @if (!string.IsNullOrEmpty(ViewBag.CompanyName))
                                        {
                                            <div class="daily-offer-contact-row">
                                                <i class="fas fa-building daily-offer-contact-icon"></i>
                                                <span>@ViewBag.CompanyName</span>
                                            </div>
                                        }
                                    </div>
                                    <div class="daily-offer-contact-btns">
                                        <a href="javascript:void(0)" class="daily-offer-contact-btn daily-offer-wa-btn" onclick="sendMessageToWhatsapp()">
                                            <i class="fab fa-whatsapp"></i> WhatsApp
                                        </a>
                                        <a href="javascript:void(0)" class="daily-offer-contact-btn daily-offer-call-btn" onclick="makeCall()">
                                            <i class="fas fa-phone"></i> Ara
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Saƒü Taraf: Slider ve Aksiyon Butonlarƒ± -->
                        <div class="col-lg-7 col-12 order-1 order-lg-2">
                            <div class="daily-offer-right-col">
                                <!-- Swiper Container (Benzersiz ID) -->
                                <div class="daily-offer-slider-wrap">
                                    <div class="swiper dailyOfferSwiper w-100 h-100">
                                        <div class="swiper-wrapper">
                                            @if (ViewBag.Fotograflar != null && ViewBag.Fotograflar.Count > 0)
                                            {
                                                bool gununIlaniEklendi = false;
                                                for (int i = 0; i < ViewBag.Fotograflar.Count; i++)
                                                {
                                                    string photoUrl = ViewBag.Fotograflar[i].Url.ToString();
                                                    if (photoUrl.Contains("wwwroot"))
                                                    {
                                                        int idx = photoUrl.IndexOf("wwwroot");
                                                        photoUrl = photoUrl.Substring(idx + 8).Replace("\\", "/");
                                                        if (!photoUrl.StartsWith("/")) photoUrl = "/" + photoUrl;
                                                    }
                                                    else if (photoUrl.Contains("images"))
                                                    {
                                                        int idx = photoUrl.IndexOf("images");
                                                        photoUrl = "/" + photoUrl.Substring(idx).Replace("\\", "/");
                                                    }

                                                    <div class="swiper-slide">
                                                        <img src="@photoUrl" alt="ƒ∞lan Resmi" loading="lazy" style="object-fit: contain;" />
                                                    </div>

                                                    if (!gununIlaniEklendi && i == (ViewBag.Fotograflar.Count / 2))
                                                    {
                                                        <div class="swiper-slide">
                                                            <img src="~/ImageFiles/gununilani.png" alt="G√ºn√ºn ƒ∞lanƒ±" loading="lazy" style="object-fit: contain;" />
                                                        </div>
                                                        gununIlaniEklendi = true;
                                                    }
                                                }
                                            }
                                            else
                                            {
                                                <div class="swiper-slide d-flex align-items-center justify-content-center text-white">
                                                    <div class="text-center">
                                                        <i class="fas fa-camera fa-3x mb-2"></i>
                                                        <p>Fotoƒüraf Yok</p>
                                                    </div>
                                                </div>
                                            }
                                        </div>
                                        <div class="swiper-button-next"></div>
                                        <div class="swiper-button-prev"></div>
                                    </div>
                                </div>

                                <!-- Alt Aksiyon Butonlarƒ± -->
                                <div class="daily-offer-action-box">
                                    <a href="@Url.Action("ilansayfasi", "Ilan", new { id = ViewBag.GununIlan.Id })" class="daily-offer-action-btn daily-offer-btn-primary">
                                        <i class="fas fa-eye"></i> ƒ∞lana Git
                                    </a>
                                    <a href="@Url.Action("GununIlaniSiparisi", "Home")" class="daily-offer-action-btn daily-offer-btn-orange">
                                        <i class="fas fa-star"></i> G√ºn√ºn ƒ∞lanƒ± Ver
                                    </a>
                                    <div class="daily-offer-view-cnt">
                                        <i class="fas fa-eye"></i>
                                        <span id="dailyOfferViewCountText">@ViewBag.GununIlan.GoruntulenmeSayisi g√∂r√ºnt√ºlenme</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
}

<!-- Y√ºzen buton -->
<a href="#" id="floating-offer-icon" class="floating-offer-link">
    <img src="~/ImageFiles/G√úN√úNƒ∞LANƒ∞.webp" alt="G√ºn√ºn ƒ∞lanƒ±" class="floating-offer-img" loading="lazy" width="100" height="100">
</a>

<div class="tagline-container1" style="display: flex;">
    <h2 class="tagline" style="font-family: 'Caveat', cursive; font-weight: 700;">YENƒ∞ NESƒ∞L ƒ∞LAN Sƒ∞TESƒ∞</h2>
</div>

<!-- Arama Formu ve Filtreler -->
<form asp-action="HizliAra" asp-controller="Ilan" method="post">
    <!-- Arama ve Se√ßenekler Kutusu -->
    <div class="custom-search-container">
        <!-- Arama Kutusu -->
        <div class="search-section">
            <input type="text"
                   class="custom-search-input"
                   id="siteSearchInput"
                   name="anahtarKelime"
                   placeholder="Aradƒ±ƒüƒ±nƒ±z ≈üeyi yazƒ±n..."
                   value="@ViewBag.AnahtarKelime" />
            <button type="submit" class="custom-search-button">Ara<i class=" fa-solid fa-magnifying-glass"></i></button>
        </div>
    </div>
</form>

<div class="tagline-container">
    <!-- Se√ßenekler Penceresi -->
    <div class="custom-options-container">
        <div class="options-header">Filtreli Arama</div>
        <div class="options-tabs">
            <button class="option-tab" onclick="showOption('konut')">
                Konut <span class="dropdown-icon"></span>
            </button>
            <button class="option-tab" onclick="showOption('arazi')">
                Arsa <span class="dropdown-icon"></span>
            </button>
            <button class="option-tab" onclick="showOption('bahce')">
                Bah√ße <span class="dropdown-icon"></span>
            </button>
            <button class="option-tab" onclick="showOption('tarla')">
                Tarla <span class="dropdown-icon"></span>
            </button>
            <button class="option-tab" onclick="showOption('is_yeri')">
                ƒ∞≈ü Yeri <span class="dropdown-icon"></span>
            </button>
            <button class="option-tab" onclick="showOption('turistik')">
                Turistik Tesis <span class="dropdown-icon"></span>
            </button>
        </div>

        <div class="options-content">
            <!-- (Buradaki formlar orjinal dosyadan birebir kopyalanmƒ±≈ütƒ±r, √∂zet ge√ßilmemi≈ütir) -->
            <!-- Konut Se√ßeneƒüi -->
            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="konut" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="Konut (Ya≈üam Alanƒ±)">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu">
                            <option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option>
                            <option value="Kiralƒ±k">Kiralƒ±k</option>
                            <option value="Devren Satƒ±lƒ±k">Devren Satƒ±lƒ±k</option>
                            <option value="Devren Kiralƒ±k">Devren Kiralƒ±k</option>
                        </select>
                        <select name="detayliAramaRequestDTO.MulkTipi">
                            <option value="Daire">Daire</option>
                            <option value="M√ºstakil Ev">M√ºstakil Ev</option>
                            <option value="K√∂y Evi">K√∂y Evi</option>
                            <option value="Eski, Kargir Ev">Eski, Kargir Ev</option>
                            <option value="Daƒü Evi">Daƒü Evi</option>
                            <option value="Kerpi√ß Ev">Kerpi√ß Ev</option>
                            <option value="Samanlƒ±k">Samanlƒ±k</option>
                            <option value="Kul√ºbe">Kul√ºbe</option>
                            <option value="Konteyner">Konteyner</option>
                            <option value="Prefabrik">Prefabrik</option>
                            <option value="Bungalow">Bungalow</option>
                            <option value="Tiny House">Tiny House</option>
                            <option value="Loft Daire">Loft Daire</option>
                            <option value="Bina">Bina</option>
                            <option value="Devrem√ºlk">Devrem√ºlk</option>
                            <option value="√áiftlik Evi">√áiftlik Evi</option>
                            <option value="Kooperatif">Kooperatif</option>
                            <option value="Villa">Villa</option>
                            <option value="K√∂≈ük">K√∂≈ük</option>
                            <option value="Konak">Konak</option>
                            <option value="Yalƒ±">Yalƒ±</option>
                            <option value="Ev ve Ahƒ±r">Ev ve Ahƒ±r</option>
                            <option value="Rezidans">Rezidans</option>
                            <option value="Diƒüer">Diƒüer</option>
                        </select>
                    </div>
                    <div class="location-group">
                        <select name="detayliAramaRequestDTO.Il" id="sehir"><option value="">ƒ∞l Se√ßiniz</option></select>
                        <select name="detayliAramaRequestDTO.Ilce" id="semt"><option value="">ƒ∞l√ße Se√ßiniz</option></select>
                        <select name="detayliAramaRequestDTO.Mahalle" id="mahalle"><option value="">Mahalle/K√∂y Se√ßiniz</option></select>
                    </div>
                    <div class="price-group">
                        <input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL">
                        <input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL">
                    </div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>

            <!-- Arsa, Bah√ße, Tarla vb. diƒüer formlar aynen korunmu≈ütur (yer kaplamasƒ±n diye burada kƒ±saltmƒ±yorum ama dosyada tam olacak) -->
            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="arazi" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="Arsa">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu"><option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option><option value="Kiralƒ±k">Kiralƒ±k</option><option value="Kat Kar≈üƒ±lƒ±ƒüƒ±">Kat Kar≈üƒ±lƒ±ƒüƒ±</option></select>
                        <select name="detayliAramaRequestDTO.ArsaTipi"><option value="A-Lejantlƒ± Arsa">A-Lejantlƒ± Arsa</option><option value="Bah√ße">Bah√ße</option><option value="√áiftlik">√áiftlik</option><option value="Depo Ve Antrepo">Depo Ve Antrepo</option><option value="Eƒüitim">Eƒüitim</option><option value="Enerji Depolama">Enerji Depolama</option><option value="Hastane">Hastane</option><option value="Kamu Alanƒ±">Kamu Alanƒ±</option><option value="Karma">Karma</option><option value="Konut">Konut</option><option value="Konut + Ticaret">Konut + Ticaret</option><option value="Muhtelif Arsa">Muhtelif Arsa</option><option value="√ñzel Kullanƒ±m">√ñzel Kullanƒ±m</option><option value="Petrol Lejantƒ±">Petrol Lejantƒ±</option><option value="Sanayi">Sanayi</option><option value="Saƒülƒ±k">Saƒülƒ±k</option><option value="Sera">Sera</option><option value="Sit Alanƒ±">Sit Alanƒ±</option><option value="Spor Alanƒ±">Spor Alanƒ±</option><option value="Tarƒ±m">Tarƒ±m</option><option value="Ticaret">Ticaret</option><option value="Toplu Konut">Toplu Konut</option><option value="Turizm">Turizm</option><option value="Turizm Arsa">Turizm Arsa</option><option value="Ye≈üil Alan">Ye≈üil Alan</option><option value="Diƒüer">Diƒüer</option></select>
                    </div>
                    <div class="location-group"><select name="detayliAramaRequestDTO.Il" id="sehirArsa"><option value="">ƒ∞l Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Ilce" id="semtArsa"><option value="">ƒ∞l√ße Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Mahalle" id="mahalleArsa"><option value="">Mahalle/K√∂y Se√ßiniz</option></select></div>
                    <div class="price-group"><input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL"><input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL"></div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>

            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="bahce" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="Bah√ße">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu"><option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option><option value="Kiralƒ±k">Kiralƒ±k</option><option value="Kat Kar≈üƒ±lƒ±ƒüƒ±">Kat Kar≈üƒ±lƒ±ƒüƒ±</option></select>
                        <select name="detayliAramaRequestDTO.MeyveTuru"><option value="Ahududu">Ahududu</option><option value="Armut">Armut</option><option value="Avokado">Avokado</option><option value="Ayva">Ayva</option><option value="Badem">Badem</option><option value="B√∂ƒü√ºrtlen">B√∂ƒü√ºrtlen</option><option value="Ceviz">Ceviz</option><option value="√áilek">√áilek</option><option value="Dut">Dut</option><option value="Elma">Elma</option><option value="Erik">Erik</option><option value="Fƒ±ndƒ±k">Fƒ±ndƒ±k</option><option value="Greyfurt">Greyfurt</option><option value="Hurma">Hurma</option><option value="ƒ∞ƒüde">ƒ∞ƒüde</option><option value="Kayƒ±sƒ±">Kayƒ±sƒ±</option><option value="Kestane">Kestane</option><option value="Kivi">Kivi</option><option value="Kƒ±zƒ±lcƒ±k">Kƒ±zƒ±lcƒ±k</option><option value="Kiraz">Kiraz</option><option value="Karƒ±≈üƒ±k">Karƒ±≈üƒ±k</option><option value="Lavanta">Lavanta</option><option value="Limon">Limon</option><option value="Mandalina">Mandalina</option><option value="Mu≈ümula">Mu≈ümula</option><option value="Muz">Muz</option><option value="Nar">Nar</option><option value="Portakal">Portakal</option><option value="≈ûeftali">≈ûeftali</option><option value="√úz√ºm">√úz√ºm</option><option value="Vi≈üne">Vi≈üne</option><option value="Zeytin">Zeytin</option><option value="Diƒüer">Diƒüer</option></select>
                    </div>
                    <div class="location-group"><select name="detayliAramaRequestDTO.Il" id="sehirBahce"><option value="">ƒ∞l Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Ilce" id="semtBahce"><option value="">ƒ∞l√ße Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Mahalle" id="mahalleBahce"><option value="">Mahalle/K√∂y Se√ßiniz</option></select></div>
                    <div class="price-group"><input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL"><input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL"></div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>

            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="tarla" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="Tarla">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu"><option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option><option value="Kiralƒ±k">Kiralƒ±k</option><option value="Kat Kar≈üƒ±lƒ±ƒüƒ±">Kat Kar≈üƒ±lƒ±ƒüƒ±</option></select>
                        <select name="detayliAramaRequestDTO.UrunTuru"><option value="Ay√ßi√ßeƒüi">Ay√ßi√ßeƒüi</option><option value="Bakla">Bakla</option><option value="Bamya">Bamya</option><option value="Baƒü">Baƒü</option><option value="Bezelye">Bezelye</option><option value="√áay">√áay</option><option value="√áilek">√áilek</option><option value="Fasulye">Fasulye</option><option value="Ispanak">Ispanak</option><option value="Kabak">Kabak</option><option value="Marul">Marul</option><option value="Patlƒ±can">Patlƒ±can</option><option value="Salatalƒ±k">Salatalƒ±k</option><option value="Sarƒ±msak">Sarƒ±msak</option><option value="Tarla+Baƒü">Tarla+Baƒü</option><option value="T√ºt√ºn">T√ºt√ºn</option><option value="Yer Fƒ±stƒ±ƒüƒ±">Yer Fƒ±stƒ±ƒüƒ±</option><option value="Diƒüer">Diƒüer</option></select>
                    </div>
                    <div class="location-group"><select name="detayliAramaRequestDTO.Il" id="sehirTarla"><option value="">ƒ∞l Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Ilce" id="semtTarla"><option value="">ƒ∞l√ße Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Mahalle" id="mahalleTarla"><option value="">Mahalle/K√∂y Se√ßiniz</option></select></div>
                    <div class="price-group"><input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL"><input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL"></div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>

            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="is_yeri" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="ƒ∞≈ü Yeri">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu"><option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option><option value="Kiralƒ±k">Kiralƒ±k</option><option value="Devren Satƒ±lƒ±k">Devren Satƒ±lƒ±k</option><option value="Devren Kiralƒ±k">Devren Kiralƒ±k</option></select>
                        <select name="detayliAramaRequestDTO.IsYeriTuru"><option value="Akaryakƒ±t ƒ∞stasyonu">Akaryakƒ±t ƒ∞stasyonu</option><option value="Apartman Dairesi">Apartman Dairesi</option><option value="A≈üevi">A≈üevi</option><option value="At√∂lye">At√∂lye</option><option value="AVM">AVM</option><option value="Bakkal">Bakkal</option><option value="Beyaz E≈üya">Beyaz E≈üya</option><option value="Bina">Bina</option><option value="B√ºfe">B√ºfe</option><option value="B√ºro & Ofis">B√ºro & Ofis</option><option value="√áay Bah√ßesi">√áay Bah√ßesi</option><option value="√áiftlik">√áiftlik</option><option value="Depo & Antrepo">Depo & Antrepo</option><option value="Dershane">Dershane</option><option value="D√ºƒü√ºn Salonu">D√ºƒü√ºn Salonu</option><option value="D√ºkkan & Maƒüaza">D√ºkkan & Maƒüaza</option><option value="Eczane">Eczane</option><option value="Enerji Santrali">Enerji Santrali</option><option value="Fabrika & √úretim Tesisi">Fabrika & √úretim Tesisi</option><option value="Fƒ±rƒ±n & Tatlƒ±cƒ±">Fƒ±rƒ±n & Tatlƒ±cƒ±</option><option value="Garaj & Park Yeri">Garaj & Park Yeri</option><option value="Genel">Genel</option><option value="Hamam & Sauna">Hamam & Sauna</option><option value="Hastane">Hastane</option><option value="Huzurevi">Huzurevi</option><option value="ƒ∞malathane">ƒ∞malathane</option><option value="ƒ∞≈ü Hanƒ± Katƒ± & Ofisi">ƒ∞≈ü Hanƒ± Katƒ± & Ofisi</option><option value="Kahvehane">Kahvehane</option><option value="Kamu Binasƒ±">Kamu Binasƒ±</option><option value="Kantin">Kantin</option><option value="Kƒ±r & Kahvaltƒ± Bah√ßesi">Kƒ±r & Kahvaltƒ± Bah√ßesi</option><option value="Kƒ±raathane">Kƒ±raathane</option><option value="Komple Bina">Komple Bina</option><option value="Konfeksiyon">Konfeksiyon</option><option value="Market">Market</option><option value="Maden Ocaƒüƒ±">Maden Ocaƒüƒ±</option><option value="M√ºstakil ƒ∞≈ü Yeri">M√ºstakil ƒ∞≈ü Yeri</option><option value="Otopark">Otopark</option><option value="Pastane">Pastane</option><option value="Pazar Yeri">Pazar Yeri</option><option value="Plaza">Plaza</option><option value="Plaza Katƒ± & Ofisi">Plaza Katƒ± & Ofisi</option><option value="Radyo ƒ∞stasyonu & TV Kanalƒ±">Radyo ƒ∞stasyonu & TV Kanalƒ±</option><option value="Restoran & Lokanta">Restoran & Lokanta</option><option value="Rezidans">Rezidans</option><option value="Rezidans Katƒ± & Ofisi">Rezidans Katƒ± & Ofisi</option><option value="Saƒülƒ±k Merkezi">Saƒülƒ±k Merkezi</option></select>
                    </div>
                    <div class="location-group"><select name="detayliAramaRequestDTO.Il" id="sehirIsYeri"><option value="">ƒ∞l Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Ilce" id="semtIsYeri"><option value="">ƒ∞l√ße Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Mahalle" id="mahalleIsYeri"><option value="">Mahalle/K√∂y Se√ßiniz</option></select></div>
                    <div class="price-group"><input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL"><input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL"></div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>

            <form asp-action="HizliAra" asp-controller="Ilan" method="post">
                <div id="turistik" class="option-details">
                    <input type="hidden" name="detayliAramaRequestDTO.Kategori" value="Turistik Tesis">
                    <div class="filter-group">
                        <select name="detayliAramaRequestDTO.KonutDurumu"><option value="Satƒ±lƒ±k">Satƒ±lƒ±k</option><option value="Kiralƒ±k">Kiralƒ±k</option><option value="Devren Satƒ±lƒ±k">Devren Satƒ±lƒ±k</option><option value="Devren Kiralƒ±k">Devren Kiralƒ±k</option></select>
                        <select name="detayliAramaRequestDTO.TesisTuru"><option value="1 Yƒ±ldƒ±zlƒ± Otel">1 Yƒ±ldƒ±zlƒ± Otel</option><option value="2 Yƒ±ldƒ±zlƒ± Otel">2 Yƒ±ldƒ±zlƒ± Otel</option><option value="3 Yƒ±ldƒ±zlƒ± Otel">3 Yƒ±ldƒ±zlƒ± Otel</option><option value="4 Yƒ±ldƒ±zlƒ± Otel">4 Yƒ±ldƒ±zlƒ± Otel</option><option value="5 Yƒ±ldƒ±zlƒ± Otel">5 Yƒ±ldƒ±zlƒ± Otel</option><option value="Apart">Apart</option><option value="Bungalov">Bungalov</option><option value="Butik Otel">Butik Otel</option><option value="Daƒü Evi">Daƒü Evi</option><option value="Devrem√ºlk">Devrem√ºlk</option><option value="Kamp Alanƒ±">Kamp Alanƒ±</option><option value="Tiny House">Tiny House</option><option value="Yazlƒ±k">Yazlƒ±k</option><option value="Diƒüer">Diƒüer</option></select>
                    </div>
                    <div class="location-group"><select name="detayliAramaRequestDTO.Il" id="sehirTuristik"><option value="">ƒ∞l Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Ilce" id="semtTuristik"><option value="">ƒ∞l√ße Se√ßiniz</option></select><select name="detayliAramaRequestDTO.Mahalle" id="mahalleTuristik"><option value="">Mahalle/K√∂y Se√ßiniz</option></select></div>
                    <div class="price-group"><input type="text" name="detayliAramaRequestDTO.EnDusukFiyat" placeholder="Minimum TL"><input type="text" name="detayliAramaRequestDTO.EnYuksekFiyat" placeholder="Maximum TL"></div>
                    <button type="submit" class="search-button">Ara</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="background-murat" style="background-image: url('/ImageFiles/arkaplan.webp');">
    <!-- Diƒüer HTML i√ßeriƒüiniz buraya gelebilir -->
</div>

<!-- ORƒ∞Jƒ∞NAL POPUPS CONTAINER (Hƒ∞√á DEƒûƒ∞≈ûTƒ∞Rƒ∞LMEDEN) -->
<div class="popups-container">

    <!-- √úcretsiz Hizmet Penceresi -->
    <div class="service-popup" id="service-popup" onclick="window.location.href='@Url.Action("MulkumuSatmakIstiyorum", "Form")'">
        <img src="~/images/tl_ikon.webp" alt="M√ºlk Resmi" class="property-image" loading="lazy" width="200" height="150">
        <h3>M√úLK√úM√ú SATMAK ƒ∞STƒ∞YORUM</h3>
        <p>M√ºlk bilgilerini girin. Deƒüerlendirip, o b√∂lgedeki profesyonel √ºyelerimizden en az 20 emlak√ßƒ±ya&nbsp;y√∂nlendirelim</p>
        <span class="label">√úcretsiz Hizmet</span>
        <!-- Bilgilendirme Simgesi -->
        <div class="info-icon" data-tooltip="Bu form, m√ºlk√ºn√ºz√º satma s√ºrecinizi kolayla≈ütƒ±rmak i√ßin tasarlandƒ±. M√ºlk bilgilerinizi girdikten sonra, hƒ±zlƒ± bir deƒüerlendirme yapƒ±lacak ve en kƒ±sa s√ºrede sizinle ileti≈üime ge√ßilecektir. Doƒürulama sonrasƒ± √ßok√ßa telefon alabilirsiniz. M√ºlk√ºn√ºz√º satmasƒ± i√ßin 20 emlak√ßƒ± sizi arayabilir. Dilediƒüiniz emlak√ßƒ±ya teslim edebilirsiniz.
                 Umarƒ±m&nbsp;beƒüenirsiniz!">
            <span>!</span>
        </div>
    </div>
    <!-- √úcretsiz Hizmet Penceresi -->
    <div class="service-popup-2" id="servicePopup" onclick="window.location.href='@Url.Action("YatirimYapmakIstiyorum", "Form")'">
        <img src="~/images/banabul.webp" alt="M√ºlk Resmi" class="property-image-2" loading="lazy" width="200" height="150">
        <h3>YATIRIM YAPMAK <br />ƒ∞STƒ∞YORUM</h3>
        <p>Aradƒ±ƒüƒ±nƒ±z m√ºlk√ºn √∂zelliklerini girin. <br />Size en uygun m√ºlk√º bulalƒ±m</p>
        <span class="label-2">√úcretsiz Hizmet</span>
    </div>
    <!-- ≈ûevvalDrone Hizmet Penceresi -->
    <div class="sevvaldrone-popup" id="sevvaldrone-popup">
        <div class="drone-icon">
            <!-- G√ºncellenmi≈ü Drone ƒ∞konu (PNG) -->
            <img src="https://cdn-icons-png.flaticon.com/128/7504/7504454.png"
                 alt="Drone ƒ∞konu"
                 loading="lazy"
                 width="80" height="80"
                 onerror="this.onerror=null;this.src='https://cdn-icons-png.flaticon.com/128/7504/7504454.png';"
                 class="w-full h-full object-contain rounded-full">
        </div>
        <h3>≈ûEVVALDRONE</h3>
        <p>M√ºlk√ºn√ºz√º ≈ûevvalDrone ile hƒ±zlƒ±ca videolandƒ±rƒ±n</p>
        <span class="label">300‚Ç∫</span>
    </div>

</div>

<!-- Video G√∂sterme Modalƒ± -->
<div id="video-modal" class="video-modal">
    <div class="video-modal-content">
        <button class="close-button" id="close-video-modal">&times;</button>
        <iframe id="youtube-video-player" width="560" height="315" src="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
        <p class="order-text">Sipari≈ü Ver</p>
        <a href="#" class="whatsapp-button" id="whatsapp-order-button">
            <i class="fab fa-whatsapp"></i> WhatsApp'tan Mesaj G√∂nder
        </a>
    </div>
</div>

<script>
    // Sayƒ±yƒ± noktalarla formatlayan fonksiyon
    function formatNumber(number) {
        return number.toLocaleString('tr-TR'); // T√ºrk√ße formatƒ± kullanƒ±r
    }
    // Toplam ve aktif ziyaret√ßi sayƒ±sƒ±nƒ± g√ºncelleyen fonksiyon
    async function updateVisitorCounts() {
        try {
            // Aktif ziyaret√ßi sayƒ±sƒ±nƒ± al
            const activeResponse = await fetch('/api/visitor/active');
            const activeCount = await activeResponse.json();
            // Toplam ziyaret√ßi sayƒ±sƒ±nƒ± al
            const totalResponse = await fetch('/api/visitor/total');
            const totalCount = await totalResponse.json();
            
            // API response formatƒ±: { Data: { ActiveVisitorCount: number, TotalVisitorCount: number } }
            const activeVisitorCount = activeCount?.Data?.ActiveVisitorCount || activeCount?.data?.activeVisitorCount || activeCount?.ActiveVisitorCount || activeCount || 0;
            const totalVisitorCount = totalCount?.Data?.TotalVisitorCount || totalCount?.data?.totalVisitorCount || totalCount?.TotalVisitorCount || totalCount || 0;
            
            // Sayƒ±larƒ± HTML'de g√ºncelle ve formatla (navbar i√ßin)
            const activeEl = document.getElementById('active-visitors-navbar');
            if (activeEl) activeEl.textContent = formatNumber(activeVisitorCount);
            
            const totalEl = document.getElementById('total-visitors-navbar');
            if (totalEl) totalEl.textContent = formatNumber(totalVisitorCount);
        } catch (error) {
            console.error('Ziyaret√ßi sayƒ±larƒ± g√ºncellenirken hata olu≈ütu:', error);
        }
    }
    // Kullanƒ±cƒ± siteye girdiƒüinde ziyaret√ßi kaydƒ±nƒ± olu≈ütur
    async function recordVisitor() {
        try {
            await fetch('/api/visitor/enter', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                }
            });
        } catch (error) {
            console.error('Ziyaret√ßi kaydƒ± olu≈üturulurken hata olu≈ütu:', error);
        }
    }
    // Kullanƒ±cƒ± siteyi kapattƒ±ƒüƒ±nda ziyaret√ßi kaydƒ±nƒ± sil
    async function exitVisitor(visitorId) {
        try {
            await fetch(`/api/visitor/exit?visitorId=${visitorId}`, {
                method: 'POST'
            });
        } catch (error) {
            console.error('Ziyaret√ßi √ßƒ±kƒ±≈ü kaydƒ± olu≈üturulurken hata olu≈ütu:', error);
        }
    }
    // Sayfa y√ºklendiƒüinde ziyaret√ßi kaydƒ±nƒ± olu≈ütur ve sayƒ±larƒ± g√ºncelle
    document.addEventListener('DOMContentLoaded', () => {
        recordVisitor(); // Ziyaret√ßi kaydƒ±nƒ± olu≈ütur
        updateVisitorCounts(); // ƒ∞lk g√ºncellemeyi yap
        // Her 5 saniyede bir g√ºncellemeleri tekrarla
        setInterval(updateVisitorCounts, 5000);
        // Kullanƒ±cƒ± siteyi kapattƒ±ƒüƒ±nda ziyaret√ßi kaydƒ±nƒ± sil
        window.addEventListener('beforeunload', () => {
            const visitorId = localStorage.getItem('visitorId'); // Kullanƒ±cƒ±ya √∂zel bir ID tutuyorsanƒ±z
            if (visitorId) {
                exitVisitor(visitorId);
            }
        });

             // ≈ûevvalDrone popup'ƒ± ve video modalƒ± i√ßin event listener'lar
        const sevvalDronePopup = document.getElementById('sevvaldrone-popup');
        const videoModal = document.getElementById('video-modal');
        const closeVideoModalButton = document.getElementById('close-video-modal');
        const youtubeVideoPlayer = document.getElementById('youtube-video-player');
        const whatsappOrderButton = document.getElementById('whatsapp-order-button');

        const videoUrl = "https://www.youtube.com/embed/4GOC1El49Qk?autoplay=1&loop=1&playlist=4GOC1El49Qk&mute=1";


        sevvalDronePopup.addEventListener('click', () => {
            // Not: videoUrl zaten autoplay parametresini i√ßeriyor, bu y√ºzden tekrar eklemeye gerek yok.
            youtubeVideoPlayer.src = videoUrl; // Videoyu oynat
            videoModal.style.display = 'flex';
        });

        closeVideoModalButton.addEventListener('click', () => {
            youtubeVideoPlayer.src = ""; // Videoyu durdur
            videoModal.style.display = 'none';
        });

        videoModal.addEventListener('click', (event) => {
            if (event.target === videoModal) {
                youtubeVideoPlayer.src = ""; // Videoyu durdur
                videoModal.style.display = 'none';
            }
        });

        whatsappOrderButton.addEventListener('click', (event) => {
            event.preventDefault();
            const phoneNumber = "905066601624"; // 0506 660 16 24 numarasƒ±nƒ±n √ºlke kodu ile hali
            const message = encodeURIComponent("≈ûevvalDrone hizmeti almak istiyorum");
            let whatsappLink = `https://wa.me/${phoneNumber}?text=${message}`;

            // Mobil cihaz kontrol√º
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {
                // Mobil cihazlar i√ßin direkt WhatsApp uygulamasƒ± a√ßma denemesi
                // WhatsApp Business i√ßin √∂zel bir URL olmasa da, wa.me genellikle doƒüru uygulamayƒ± a√ßar
                whatsappLink = `whatsapp://send?phone=${phoneNumber}&text=${message}`;
            } else {
                // Bilgisayar i√ßin WhatsApp Web
                whatsappLink = `https://web.whatsapp.com/send?phone=${phoneNumber}&text=${message}`;
            }
            window.open(whatsappLink, '_blank');
        });
    });
</script>

<div class="image-container" style="margin-top: 0px;">
</div>

<div class="listings-popup">
    <h2 style="color: #0d6efd">ƒ∞lanlarƒ±mƒ±z</h2>

    @await Component.InvokeAsync("AnnouncementCards")

    <!-- Recently Visited Announcements Section -->
    @if (User.Identity.IsAuthenticated)
    {
        @await Component.InvokeAsync("RecentlyVisitedAnnouncements")
        @await Component.InvokeAsync("SuitableAnnouncements")
    }

    @await Component.InvokeAsync("CityAnnouncements", Model.SehirIlanSayilari)

    <div class="advisor-container">
        <h3 class="text-center text-white">√úyelerimiz</h3>
        <div class="advisor-wrapper" id="advisor-scroll-wrapper">
            @foreach (var user in Model.Users)
            {
                // Resim Yolu D√ºzeltme ƒ∞≈ülemi
                // Veritabanƒ±ndaki dosya yolunu production URL formatƒ±na √ßeviriyoruz.
                string photoPath = user.ProfilePicturePath;
                if (!string.IsNullOrEmpty(photoPath))
                {
                    // Ters slashleri d√ºzelt
                    photoPath = photoPath.Replace("\\", "/");

                    // Eƒüer zaten tam URL ise dokunma
                    if (!photoPath.StartsWith("http"))
                    {
                        // Eƒüer yol 'wwwroot' i√ßeriyorsa temizle
                        if (photoPath.Contains("wwwroot/"))
                        {
                            photoPath = photoPath.Substring(photoPath.IndexOf("wwwroot/") + 8);
                        }
                        else if (photoPath.Contains("wwwroot"))
                        {
                            photoPath = photoPath.Substring(photoPath.IndexOf("wwwroot") + 7);
                        }

                        // Ba≈üƒ±nda slash yoksa ekle
                        if (!photoPath.StartsWith("/"))
                        {
                            photoPath = "/" + photoPath;
                        }

                        // Yerel yolu production URL'sine √ßevir
                        photoPath = "https://www.sevval.com" + photoPath;
                    }
                }
                else
                {
                    // Fotoƒüraf yoksa varsayƒ±lan g√∂rsel
                    photoPath = "https://cdn-icons-png.flaticon.com/512/149/149071.png";
                }

                <div class="advisor-card">
                    <div class="advisor-img-wrapper">
                        <!--
                            onerror eventindeki gizleme kodunu kaldƒ±rdƒ±k.
                            B√∂ylece resim y√ºklenemese bile (kƒ±rƒ±k link vb.) kart g√∂r√ºn√ºr kalacak.
                            ƒ∞sterseniz onerror="this.src='/images/default-avatar.png'" gibi bir varsayƒ±lan resim atamasƒ± yapabilirsiniz.
                        -->
                        <img src="@photoPath" class="advisor-img" alt="Profil Fotoƒürafƒ±"
                             width="80" height="80"
                             onerror="this.onerror=null; this.src='https://cdn-icons-png.flaticon.com/512/149/149071.png';">
                    </div>
                    <div class="advisor-info">
                        @{
                            string fullName = user.FirstName + " " + user.LastName;
                            string truncatedName = fullName.Length > 15 ? fullName.Substring(0, 15) + "..." : fullName;
                        }
                        <h5 class="advisor-name">@truncatedName</h5>
                        <p class="advisor-email">@user.UserTypes</p>
                        <a href="@Url.Action("UserIlanlar", "Ilan", new { email = user.Email })" class="advisor-btn">Sayfaya Git</a>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- WhatsApp Logo -->
    <a id="whatsapp-link-8" href="https://wa.me/905070775666?text=Merhaba%2C%20%C5%9Eevval%20Emlak%20Sitesinden%20Size%20Ula%C5%9F%C4%B1yorum" target="_blank" class="whatsapp-float">
        <img src="~/sablon/img/724destek.webp" alt="WhatsApp" class="whatsapp-image" loading="lazy" width="90" height="90">
    </a>

    <div class="comments-section">

        @{
            // NOT: Yorumlarƒ± rastgele deƒüil, tarihe g√∂re sƒ±ralƒ± g√∂stermek daha mantƒ±klƒ± olabilir
            // ama orjinal koddaki random mantƒ±ƒüƒ± korundu, sadece controller'dan gelen filtreli liste kullanƒ±ldƒ±
            var displayComments = Model.Comments;
        }

        <h3>Son Yorumlar</h3>
        <div class="comments-container">
            @if (displayComments.Any())
            {
                @foreach (var comment in displayComments)
                {
                    <div class="comment-card @(User.Identity.Name == "sftumen41@gmail.com" && !comment.IsApproved ? "comment-unapproved" : "")" id="comment-@comment.Id">
                        @if (User.Identity.IsAuthenticated && (User.Identity.Name == "sftumen41@gmail.com" || User.Identity.Name == "exdel.txt@gmail.com"))
                        {
                            <button class="comment-delete-btn-corner" onclick="deleteComment(@comment.Id)" type="button" title="Yorumu Sil">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        }
                        <p class="comment-user">
                            <strong>@comment.UserFullName</strong>
                            <span class="comment-date">(@comment.CreatedAt.ToString("dd MMMM yyyy HH:mm", new System.Globalization.CultureInfo("tr-TR")))</span>
                        </p>
                        <p class="comment-content">@Html.Raw(comment.Content)</p>
                        @if (User.Identity.IsAuthenticated && User.Identity.Name == "sftumen41@gmail.com" && !comment.IsApproved)
                        {
                            <div class="comment-admin-actions">
                                <button class="comment-approve-btn" onclick="approveComment(@comment.Id)" type="button">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    Onayla
                                </button>
                            </div>
                        }
                    </div>
                }
            }
            else
            {
                <p style="text-align:center; color:#666;">Hen√ºz g√∂r√ºnt√ºlenecek yorum yok.</p>
            }
        </div>
        <a href="@Url.Action("TumYorumlar", "Home")" class="show-more-btn" id="show-more-btn">T√ºm Yorumlar</a>
        <!-- Yorum ekleme formu a≈üaƒüƒ± ta≈üƒ±ndƒ± -->
        @if (User.Identity.IsAuthenticated)
        {
            <form asp-action="AddComment" method="post" class="comment-form" onsubmit="var t=this.querySelector('textarea[name=content]'); if(!t.value.trim()){alert('L√ºtfen bir yorum yazƒ±n.');return false;}">
                <textarea name="content" rows="4" placeholder="Yorumunuzu yazƒ±n... (Enter ile g√∂nder)" required onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); if(this.value.trim()) this.form.submit(); else alert('L√ºtfen bir yorum yazƒ±n.'); }"></textarea>
                <button type="submit">Yorum Yap</button>
            </form>
        }
        else
        {
            <!-- √úye olmayan kullanƒ±cƒ± i√ßin isim, soyisim ve yorum alanlarƒ±nƒ± i√ßeren form -->
            <form asp-action="AddComment" method="post" class="comment-form" onsubmit="var t=this.querySelector('textarea[name=content]'); if(!t.value.trim()){alert('L√ºtfen bir yorum yazƒ±n.');return false;}">
                <input type="text" name="firstName" placeholder="ƒ∞sim" required />
                <input type="text" name="lastName" placeholder="Soyisim" required />
                <textarea name="content" rows="4" placeholder="Yorumunuzu yazƒ±n... (Enter ile g√∂nder)" required onkeydown="if(event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); if(this.value.trim()) this.form.submit(); else alert('L√ºtfen bir yorum yazƒ±n.'); }"></textarea>
                <button type="submit">Yorum Yap</button>
            </form>
        }

    </div>

    <div class="gif-container">
        <a href="https://www.instagram.com/tunalavanta/" target="_blank" rel="noopener noreferrer">
            <img src="~/sablon/img/lavanta.gif" alt="Instagram GIF" class="centered-gif" loading="lazy" width="300" height="300">
        </a>
    </div>

    <!-- ƒ∞leti≈üim Penceresi -->
    <div class="contact-popup">
        <div class="contact-left">
            <img src="~/images/≈üevvalemlak.webp" alt="ƒ∞leti≈üim Resmi" class="contact-image" loading="lazy" width="300" height="200">
        </div>
        <div class="contact-right">
            <h2>Bizimle ƒ∞leti≈üime Ge√ßin</h2>
            <p>Sizin i√ßin en iyi yatƒ±rƒ±ma yardƒ±mcƒ± olalƒ±m! Satƒ±n almak, kiralamak veya satmak istiyorsanƒ±z, deneyimli danƒ±≈ümanlarƒ±mƒ±zla ileti≈üime ge√ßerek hemen adƒ±m atƒ±n.</p>
            <a id="whatsapp-link-7" class="whatsapp-button" target="_blank" href="https://wa.me/905070775666?text=Merhaba%2C%20%C5%9Eevval%20Emlak%20Sitesinden%20Size%20Ula%C5%9F%C4%B1yorum">
                <img src="~/sablon/img/WhatsApp_icon.webp" alt="WhatsApp ƒ∞konu" class="whatsapp-icon" loading="lazy" width="24" height="24">
                7/24 WhatsApp Destek
            </a>

        </div>
    </div>
</div>

@section Scripts {
    <!-- Bootstrap 5 JS Bundle (with Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Swiper JS -->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <script src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <script>
        // G√ºn√ºn ƒ∞lanƒ± Modal Kontrol√º
        document.addEventListener('DOMContentLoaded', function() {
            var dailyOfferModalElement = document.getElementById('dailyOfferModal');
            if (dailyOfferModalElement) {
                // Bootstrap modal instance olu≈ütur
                var dailyOfferModal = new bootstrap.Modal(dailyOfferModalElement);

                // Sayfa y√ºklendiƒüinde a√ß
                dailyOfferModal.show();

                // Floating icon'a basƒ±nca a√ß
                var floatingIcon = document.getElementById('floating-offer-icon');
                if (floatingIcon) {
                    floatingIcon.addEventListener('click', function(e) {
                        e.preventDefault();
                        dailyOfferModal.show();
                    });
                }

                // Modal a√ßƒ±ldƒ±ƒüƒ±nda Swiper'ƒ± ba≈ülat
                dailyOfferModalElement.addEventListener('shown.bs.modal', function () {
                    var swiper = new Swiper(".dailyOfferSwiper", {
                        navigation: {
                            nextEl: ".swiper-button-next",
                            prevEl: ".swiper-button-prev",
                        },
                        loop: true,
                        autoplay: {
                            delay: 3500,
                            disableOnInteraction: false,
                        },
                    });
                });
            }
        });

        // Telefon Formatlama ve Arama
        function formatPhoneNumberv1(phoneNumber) {
            const digitsOnly = phoneNumber.replace(/\D/g, '');
            if (digitsOnly.startsWith('0') && digitsOnly.length === 11) {
                return `+90${digitsOnly.substring(1)}`;
            }
            if (digitsOnly.startsWith('90') && digitsOnly.length === 12) {
                return `+${digitsOnly}`;
            }
            return phoneNumber.startsWith('+') ? phoneNumber : `+${phoneNumber}`;
        }

        function sendMessageToWhatsapp() {
            var phoneNumber = '@ViewBag?.GununIlan?.PhoneNumber';
            phoneNumber = formatPhoneNumberv1(phoneNumber);
            var message = encodeURIComponent("Merhaba ≈ûevval Emlak Sitesinden Size Ula≈üƒ±yorum ƒ∞lan Hakkƒ±nda Bilgi Almak ƒ∞stiyorum");
            if (window.innerWidth <= 800) {
                window.location.href = `https://wa.me/${phoneNumber}?text=${message}`;
            } else {
                window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
            }
        }

        function makeCall() {
            var phoneNumber = '@ViewBag?.GununIlan?.PhoneNumber';
            if (phoneNumber.charAt(0) !== '0') { phoneNumber = '0' + phoneNumber; }
            window.location.href = `tel:${phoneNumber}`;
        }
    </script>

    <script>
        // ƒ∞lan sayƒ±sƒ± daktilo efekti
        const input = document.getElementById("siteSearchInput");
        let ilanSayisi = @Model.TotalIlanlar;
        let formattedIlanSayisi = ilanSayisi.toLocaleString('tr-TR');
        let messages = [
            "Aradƒ±ƒüƒ±nƒ±z ≈üeyi yazƒ±n...",
            `"${formattedIlanSayisi}" ilan arasƒ±nda aramanƒ±zƒ± yapƒ±n...`,
            "Satƒ±lƒ±k ilanlar arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Kiralƒ±k ilanlar arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Konut ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Arsa ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Bah√ße ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Tarla ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "ƒ∞≈ü Yeri ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n...",
            "Turistik Tesis ilanlarƒ± arasƒ±nda aramanƒ±zƒ± yapƒ±n..."
        ];

        let currentMessageIndex = 0;
        let charIndex = 0;

        function typewriterEffect() {
            if (charIndex < messages[currentMessageIndex].length) {
                input.setAttribute("placeholder", messages[currentMessageIndex].substring(0, charIndex + 1));
                charIndex++;
                setTimeout(typewriterEffect, 50);
            } else {
                setTimeout(() => {
                    currentMessageIndex = (currentMessageIndex + 1) % messages.length;
                    charIndex = 0;
                    typewriterEffect();
                }, 3000);
            }
        }
        typewriterEffect();

        // Diƒüer scriptler (Visitor, LazyLoad vb.)
        function formatNumber(number) { 
            const num = typeof number === 'number' ? number : parseInt(number) || 0;
            return num.toLocaleString('tr-TR'); 
        }
        async function updateVisitorCounts() {
            try {
                const activeResponse = await fetch('/api/visitor/active');
                const activeCount = await activeResponse.json();
                const totalResponse = await fetch('/api/visitor/total');
                const totalCount = await totalResponse.json();
                
                // API response formatƒ±: { Data: { ActiveVisitorCount: number, TotalVisitorCount: number } }
                const activeVisitorCount = activeCount?.Data?.ActiveVisitorCount || activeCount?.data?.activeVisitorCount || activeCount?.ActiveVisitorCount || activeCount || 0;
                const totalVisitorCount = totalCount?.Data?.TotalVisitorCount || totalCount?.data?.totalVisitorCount || totalCount?.TotalVisitorCount || totalCount || 0;
                
                const activeEl = document.getElementById('active-visitors-navbar');
                if(activeEl) activeEl.textContent = formatNumber(activeVisitorCount);
                const totalEl = document.getElementById('total-visitors-navbar');
                if(totalEl) totalEl.textContent = formatNumber(totalVisitorCount);
            } catch (error) { 
                console.error('Ziyaret√ßi sayƒ±larƒ± g√ºncellenirken hata olu≈ütu:', error);
            }
        }
        async function recordVisitor() { try { await fetch('/api/visitor/enter', { method: 'POST', headers: { 'Content-Type': 'application/json' } }); } catch (error) { } }
        async function exitVisitor(visitorId) { try { await fetch(`/api/visitor/exit?visitorId=${visitorId}`, { method: 'POST' }); } catch (error) { } }

        document.addEventListener('DOMContentLoaded', () => {
            recordVisitor();
            updateVisitorCounts();
            setInterval(updateVisitorCounts, 5000);
            window.addEventListener('beforeunload', () => { const visitorId = localStorage.getItem('visitorId'); if (visitorId) exitVisitor(visitorId); });

            const sevvalDronePopup = document.getElementById('sevvaldrone-popup');
            const videoModal = document.getElementById('video-modal');
            const closeVideoModalButton = document.getElementById('close-video-modal');
            const youtubeVideoPlayer = document.getElementById('youtube-video-player');
            const videoUrl = "https://www.youtube.com/embed/4GOC1El49Qk?autoplay=1&loop=1&playlist=4GOC1El49Qk&mute=1";

            if(sevvalDronePopup) {
                sevvalDronePopup.addEventListener('click', () => { youtubeVideoPlayer.src = videoUrl; videoModal.style.display = 'flex'; });
            }
            if(closeVideoModalButton) {
                closeVideoModalButton.addEventListener('click', () => { youtubeVideoPlayer.src = ""; videoModal.style.display = 'none'; });
            }
            if(videoModal) {
                videoModal.addEventListener('click', (event) => { if (event.target === videoModal) { youtubeVideoPlayer.src = ""; videoModal.style.display = 'none'; } });
            }
        });

        // Yorumlar JS
        $(document).ready(function () {
            $("#show-more-btn").click(function () {
                $(".hidden-comment").toggle();
                var btnText = $(this).text() === "T√ºm√ºn√º G√∂ster" ? "Daha Az G√∂ster" : "T√ºm√ºn√º G√∂ster";
                $(this).text(btnText);
            });

            // Yorum Silme (class ile)
            $(".comment-delete-btn").click(function () {
                var commentId = $(this).data("comment-id");
                if(confirm("Yorumu silmek istediƒüinize emin misiniz?")) {
                    $.ajax({
                        url: '/Home/DeleteComment', type: 'POST', data: { commentId: commentId },
                        success: function () { $("#comment-" + commentId).remove(); },
                        error: function () { alert("Hata olu≈ütu."); }
                    });
                }
            });

            // YENƒ∞: Yorum Onaylama
            $(".comment-approve-btn").click(function () {
                var commentId = $(this).data("comment-id");
                var btn = $(this);
                $.ajax({
                    url: '/Home/ApproveComment', type: 'POST', data: { commentId: commentId },
                    success: function () {
                        // Ba≈üarƒ±lƒ± olursa butonu kaldƒ±r ve sarƒ± kenarlƒ±ƒüƒ± temizle
                        btn.remove();
                        $("#comment-" + commentId).removeClass("comment-unapproved");
                        alert("Yorum onaylandƒ±.");
                    },
                    error: function () { alert("Hata olu≈ütu."); }
                });
            });
        });

        // deleteComment fonksiyonu (onclick i√ßin)
        function deleteComment(commentId) {
            if(confirm("Yorumu silmek istediƒüinize emin misiniz?")) {
                $.ajax({
                    url: '/Home/DeleteComment',
                    type: 'POST',
                    data: { commentId: commentId },
                    success: function () {
                        $("#comment-" + commentId).remove();
                    },
                    error: function () {
                        alert("Yorum silinirken hata olu≈ütu.");
                    }
                });
            }
        }

        // approveComment fonksiyonu (onclick i√ßin)
        function approveComment(commentId) {
            $.ajax({
                url: '/Home/ApproveComment',
                type: 'POST',
                data: { commentId: commentId },
                success: function () {
                    $("#comment-" + commentId).removeClass("comment-unapproved");
                    $("#comment-" + commentId + " .comment-approve-btn").parent().remove();
                    alert("Yorum onaylandƒ±.");
                },
                error: function () {
                    alert("Yorum onaylanƒ±rken hata olu≈ütu.");
                }
            });
        }

        // Options ve Filtreleme JS
        function showOption(optionId) {
            const selectedDetail = document.getElementById(optionId);
            if (selectedDetail.classList.contains('active')) {
                selectedDetail.classList.remove('active');
                const anyActive = document.querySelector('.option-details.active') !== null;
                if (!anyActive) document.body.classList.remove('filter-open');
            } else {
                const allDetails = document.querySelectorAll('.option-details');
                allDetails.forEach(detail => detail.classList.remove('active'));
                selectedDetail.classList.add('active');
                document.body.classList.add('filter-open');
            }
        }
        document.addEventListener('click', function(event) {
            const customOptionsContainer = document.querySelector('.custom-options-container');
            if (customOptionsContainer && !customOptionsContainer.contains(event.target)) {
                const allDetails = document.querySelectorAll('.option-details');
                allDetails.forEach(detail => detail.classList.remove('active'));
                document.body.classList.remove('filter-open');
            }
        });

        function googleTranslateElementInit() { new google.translate.TranslateElement({ pageLanguage: 'tr' }, 'google_translate_element'); }

        // Searchable Select Class
        class SearchableSelect {
            constructor(originalSelect, options = {}) {
                this.originalSelect = originalSelect;
                this.placeholder = options.placeholder || originalSelect.options[0]?.text || 'Se√ßiniz';
                this.searchPlaceholder = options.searchPlaceholder || 'Ara...';
                this.onSelect = options.onSelect || null;
                this.extraClass = options.extraClass || '';
                this.items = [];
                this.filteredItems = [];
                this.highlightedIndex = -1;
                this.isOpen = false;
                this.init();
            }

            init() {
                this.createWrapper();
                this.bindEvents();
                this.loadItems();
            }

            createWrapper() {
                this.wrapper = document.createElement('div');
                this.wrapper.className = 'searchable-select-wrapper' + (this.extraClass ? ' ' + this.extraClass : '');

                this.display = document.createElement('div');
                this.display.className = 'searchable-select-display';
                this.display.textContent = this.placeholder;
                this.display.tabIndex = 0;

                this.dropdown = document.createElement('div');
                this.dropdown.className = 'searchable-select-dropdown';

                this.searchInput = document.createElement('input');
                this.searchInput.type = 'text';
                this.searchInput.className = 'searchable-select-search';
                this.searchInput.placeholder = this.searchPlaceholder;

                this.optionsContainer = document.createElement('div');
                this.optionsContainer.className = 'searchable-select-options';

                this.dropdown.appendChild(this.searchInput);
                this.dropdown.appendChild(this.optionsContainer);
                this.wrapper.appendChild(this.display);
                this.wrapper.appendChild(this.dropdown);

                this.originalSelect.style.display = 'none';
                this.originalSelect.parentNode.insertBefore(this.wrapper, this.originalSelect.nextSibling);
            }

            loadItems() {
                this.items = [];
                Array.from(this.originalSelect.options).forEach((option, index) => {
                    if (index === 0 && option.value === '') return;
                    this.items.push({ value: option.value, text: option.text });
                });
                this.filteredItems = [...this.items];
                this.renderOptions();
            }

            renderOptions() {
                this.optionsContainer.innerHTML = '';
                if (this.filteredItems.length === 0) {
                    const noResult = document.createElement('div');
                    noResult.className = 'searchable-select-option no-results';
                    noResult.textContent = 'Sonu√ß bulunamadƒ±';
                    this.optionsContainer.appendChild(noResult);
                    return;
                }
                this.filteredItems.forEach((item, index) => {
                    const option = document.createElement('div');
                    option.className = 'searchable-select-option';
                    option.textContent = item.text;
                    option.dataset.value = item.value;
                    if (this.originalSelect.value === item.value) {
                        option.classList.add('selected');
                    }
                    if (index === this.highlightedIndex) {
                        option.classList.add('highlighted');
                    }
                    option.addEventListener('click', () => this.selectItem(item));
                    this.optionsContainer.appendChild(option);
                });
            }

            selectItem(item) {
                this.originalSelect.value = item.value;
                this.display.textContent = item.text;
                this.close();
                this.originalSelect.dispatchEvent(new Event('change'));
                if (this.onSelect) this.onSelect(item);
            }

            open() {
                if (this.isOpen) return;
                this.isOpen = true;
                this.wrapper.classList.add('open');
                this.searchInput.value = '';
                this.filteredItems = [...this.items];
                this.highlightedIndex = -1;
                this.renderOptions();
                setTimeout(() => this.searchInput.focus(), 10);
            }

            close() {
                if (!this.isOpen) return;
                this.isOpen = false;
                this.wrapper.classList.remove('open');
            }

            toggle() {
                this.isOpen ? this.close() : this.open();
            }

            filter(query) {
                const normalizedQuery = this.normalizeText(query);
                this.filteredItems = this.items.filter(item =>
                    this.normalizeText(item.text).includes(normalizedQuery)
                );
                this.highlightedIndex = this.filteredItems.length > 0 ? 0 : -1;
                this.renderOptions();
            }

            normalizeText(text) {
                // √ñnce T√ºrk√ße b√ºy√ºk harfleri d√∂n√º≈üt√ºr, sonra toLowerCase
                return text
                    .replace(/ƒ∞/g, 'i')
                    .replace(/I/g, 'i')
                    .replace(/ƒû/g, 'g')
                    .replace(/√ú/g, 'u')
                    .replace(/≈û/g, 's')
                    .replace(/√ñ/g, 'o')
                    .replace(/√á/g, 'c')
                    .toLowerCase()
                    .replace(/ƒ±/g, 'i')
                    .replace(/ƒü/g, 'g')
                    .replace(/√º/g, 'u')
                    .replace(/≈ü/g, 's')
                    .replace(/√∂/g, 'o')
                    .replace(/√ß/g, 'c');
            }

            highlightNext() {
                if (this.filteredItems.length === 0) return;
                this.highlightedIndex = (this.highlightedIndex + 1) % this.filteredItems.length;
                this.renderOptions();
                this.scrollToHighlighted();
            }

            highlightPrev() {
                if (this.filteredItems.length === 0) return;
                this.highlightedIndex = this.highlightedIndex <= 0 ? this.filteredItems.length - 1 : this.highlightedIndex - 1;
                this.renderOptions();
                this.scrollToHighlighted();
            }

            scrollToHighlighted() {
                const highlighted = this.optionsContainer.querySelector('.highlighted');
                if (highlighted) {
                    highlighted.scrollIntoView({ block: 'nearest' });
                }
            }

            selectHighlighted() {
                if (this.highlightedIndex >= 0 && this.filteredItems[this.highlightedIndex]) {
                    this.selectItem(this.filteredItems[this.highlightedIndex]);
                }
            }

            bindEvents() {
                this.display.addEventListener('click', () => this.toggle());
                this.display.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        this.toggle();
                    }
                });

                this.searchInput.addEventListener('input', (e) => {
                    this.filter(e.target.value);
                });

                this.searchInput.addEventListener('keydown', (e) => {
                    switch(e.key) {
                        case 'ArrowDown':
                            e.preventDefault();
                            this.highlightNext();
                            break;
                        case 'ArrowUp':
                            e.preventDefault();
                            this.highlightPrev();
                            break;
                        case 'Enter':
                            e.preventDefault();
                            this.selectHighlighted();
                            break;
                        case 'Escape':
                            this.close();
                            break;
                    }
                });

                document.addEventListener('click', (e) => {
                    if (!this.wrapper.contains(e.target)) {
                        this.close();
                    }
                });
            }

            refresh() {
                this.loadItems();
                const selectedOption = this.originalSelect.options[this.originalSelect.selectedIndex];
                this.display.textContent = selectedOption?.value ? selectedOption.text : this.placeholder;
            }

            reset() {
                this.originalSelect.selectedIndex = 0;
                this.display.textContent = this.placeholder;
                this.loadItems();
            }
        }

        // Il/Ilce Searchable Select Initialization
        $(document).ready(function () {
            var citySelectors = ['sehir', 'sehirArsa', 'sehirBahce', 'sehirTarla', 'sehirIsYeri', 'sehirTuristik'];
            var searchableSelects = {};

            $.ajax({
                url: '/api/provinces', method: 'GET', dataType: 'json',
                success: function(provinces) {
                    citySelectors.forEach(function(id) {
                        var $select = $(`#${id}`);
                        if($select.length) {
                            provinces.forEach(function(province) { $select.append(new Option(province, province)); });

                            // Create searchable select for Il
                            searchableSelects[id] = new SearchableSelect($select[0], {
                                placeholder: 'ƒ∞l Se√ßiniz',
                                searchPlaceholder: 'ƒ∞l ara... (√∂rn: Zon, Ank, ƒ∞st)',
                                extraClass: 'location-dropdown'
                            });

                            // Create searchable select for Ilce
                            var semtId = id.replace('sehir', 'semt');
                            var $semtSelect = $(`#${semtId}`);
                            if($semtSelect.length) {
                                searchableSelects[semtId] = new SearchableSelect($semtSelect[0], {
                                    placeholder: 'ƒ∞l√ße Se√ßiniz',
                                    searchPlaceholder: 'ƒ∞l√ße ara...',
                                    extraClass: 'location-dropdown'
                                });
                            }
                        }
                    });
                }
            });

            citySelectors.forEach(function(id) {
                $(`#${id}`).change(function() {
                    var selectedProvince = $(this).val();
                    var relatedSemt = $(this).attr('id').replace('sehir', 'semt');
                    var relatedMahalle = $(this).attr('id').replace('sehir', 'mahalle');
                    $(`#${relatedSemt}`).empty().append('<option value="">ƒ∞l√ße Se√ßiniz</option>');
                    $(`#${relatedMahalle}`).empty().append('<option value="">Mahalle/K√∂y Se√ßiniz</option>');

                    // Reset searchable select for ilce
                    if (searchableSelects[relatedSemt]) {
                        searchableSelects[relatedSemt].reset();
                    }

                    if (selectedProvince) {
                        $.ajax({
                            url: '/api/districts/' + encodeURIComponent(selectedProvince), method: 'GET', dataType: 'json',
                            success: function(districts) {
                                districts.forEach(function(district) { $(`#${relatedSemt}`).append(new Option(district, district)); });
                                // Refresh searchable select for ilce
                                if (searchableSelects[relatedSemt]) {
                                    searchableSelects[relatedSemt].refresh();
                                }
                            }
                        });
                    }
                });
            });
        });

        document.addEventListener('DOMContentLoaded', function() {
            // Yatay scroll fonksiyonu
            function setupHorizontalScroll(element) {
                if (!element) return;
                let isScrolling = false;
                element.addEventListener('wheel', function(e) {
                    e.preventDefault();
                    if (!isScrolling) {
                        isScrolling = true;
                        if (e.deltaY > 0) {
                            element.scrollBy({ left: 500, behavior: 'smooth' });
                        } else {
                            element.scrollBy({ left: -500, behavior: 'smooth' });
                        }
                        setTimeout(() => isScrolling = false, 100);
                    }
                }, { passive: false });
            }

            // Advisor wrapper (√úyelerimiz) i√ßin mouse wheel scroll
            setupHorizontalScroll(document.getElementById('advisor-scroll-wrapper'));

            // ≈ûehirler wrapper i√ßin mouse wheel scroll
            setupHorizontalScroll(document.getElementById('sehirler-scroll-wrapper'));
        });

        document.addEventListener('DOMContentLoaded', function() {
            const lazyImages = document.querySelectorAll('img[loading="lazy"]');
            if ('IntersectionObserver' in window) {
                const imageObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            const img = entry.target;
                            if (img.dataset.src) { img.src = img.dataset.src; img.removeAttribute('data-src'); observer.unobserve(img); }
                        }
                    });
                });
                lazyImages.forEach(img => { imageObserver.observe(img); });
            }
            convertImagesToWebP();
        });

        function convertImagesToWebP() {
            const allImages = document.querySelectorAll('img');
            allImages.forEach(img => {
                // Hari√ß tutulacak container'lar
                if (img.closest('.service-popup') || img.closest('.service-popup-2') || img.closest('.sevvaldrone-popup') || img.closest('.swiper-slide')) return;
                // Profil resimlerini (√ºyelerimiz b√∂l√ºm√º) ve harici URL'leri hari√ß tut
                if (img.closest('.advisor-img-wrapper') || img.closest('.advisor-card')) return;
                if (img.src && img.src.includes('sevval.com')) return; // Production URL'lerini d√∂n√º≈üt√ºrme
                if (img.src && img.src.includes('flaticon.com')) return; // CDN resimlerini d√∂n√º≈üt√ºrme
                if (img.src && !img.src.includes('.webp')) { img.src = img.src.replace(/\.(jpe?g|png)$/i, '.webp'); }
            });
        }

        // ≈ûehre g√∂re arama - ≈ûehre G√∂re ƒ∞lanlar kartlarƒ± i√ßin
        function submitHizliAraSehir(sehir) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = '/Ilan/HizliAra';

            var input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'detayliAramaRequestDTO.Il';
            input.value = sehir;
            form.appendChild(input);

            document.body.appendChild(form);
            form.submit();
        }

        // Kategoriye g√∂re arama - ƒ∞lanlarƒ±mƒ±z kartlarƒ± i√ßin
        function submitHizliAraKategori(kategori) {
            var form = document.createElement('form');
            form.method = 'POST';
            form.action = '/Ilan/HizliAra';

            var input = document.createElement('input');
            input.type = 'hidden';
            input.name = 'detayliAramaRequestDTO.Kategori';
            input.value = kategori;
            form.appendChild(input);

            document.body.appendChild(form);
            form.submit();
        }
    </script>
}